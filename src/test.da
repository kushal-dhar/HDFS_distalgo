config(clock is lamport)
import DataNode


class proc(process):
    
    def setup():
        pass
    
    def run():
        #-- helloasd
        output('waiting term from namenode')
        await(received(('x','y')))
        output('received term from namenode')
        
    def receive(msg= ('x', 'y')):
        output('received hello from ')
        #send('ack', to=sender)

def main():
    
    datanodes = new(DataNode.DataNode, num=2, at='dn')
    #datanodes = new(proc, num=2)
    
    for d in datanodes:
        setup(d, args=())
    
    #start(datanodes)
    start(datanodes)
    send(('helloasd',), to=datanodes)
    send(('x','y', self), to=datanodes)
    #send(('terminate'), to=datanodes)
    
    await( len(  setof( dn, received( ('ack',dn)  )  )  ) == 2)
    adn = setof( dn, received( ('ack',dn)  )  ) 
    output('received acks from: ', adn)
    output('terminating')
    
